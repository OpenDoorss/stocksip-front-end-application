<div class="dashboard-bg">

  <app-side-navbar/>

  <div class="dashboard-main">

    <div class="dashboard-content">
      <div class="summary-alerts-container">

        <mat-card class="summary-card">
          <div class="summary-title">General Summary</div>
          <div class="summary-item"><span>üõí Sales Today:</span> S/. 450.00</div>
          <div class="summary-item"><span>üìÑ Last invoice:</span> 24/04/2025</div>
          <div class="summary-item"><span>üì¶ Products in stock:</span> 142</div>
          <div class="summary-item"><span>‚ö†Ô∏è Products with low stock:</span> {{ stockAlerts.length }}</div>
          <div class="summary-item"><span>‚è≥ Products to expire:</span> {{ expirationAlerts.length }}</div>
        </mat-card>

        <mat-card class="alerts-card">
          <div class="summary-title">Important Alerts</div>
          <ng-container *ngIf="!loadingAlerts">
            <ng-container *ngIf="stockAlerts.length > 0; else noStockAlerts">
              <div class="alert-item" *ngFor="let alert of stockAlerts.slice(0,2)">
                <div><strong>{{ alert.title }}</strong></div>
                <div class="low-stock">{{ alert.message }}</div>
              </div>
            </ng-container>
            <ng-template #noStockAlerts>
              <div class="alert-item">No urgent restock alerts.</div>
            </ng-template>
            <hr>
            <ng-container *ngIf="expirationAlerts.length > 0; else noExpAlerts">
              <div class="alert-item" *ngFor="let alert of expirationAlerts.slice(0,2)">
                <div><strong>{{ alert.title }}</strong></div>
                <div class="expiry-alert">{{ alert.message }}</div>
              </div>
            </ng-container>
            <ng-template #noExpAlerts>
              <div class="alert-item">No expiration alerts.</div>
            </ng-template>
          </ng-container>
          <div *ngIf="loadingAlerts" class="alert-item">Loading alerts...</div>
        </mat-card>
      </div>

      <mat-card class="quick-access-card">
        <div class="summary-title">Quick Access</div>
        <div class="quick-access-buttons">
          <button mat-raised-button class="access-button" [routerLink]="['/inventory']">
            Inventory
          </button>
          <button mat-raised-button class="access-button" [routerLink]="['/orders']">
            Orders
          </button>
          <button mat-raised-button class="access-button" [routerLink]="['/catalog']">
            Catalog
          </button>
          <button mat-raised-button class="access-button">
            Discounts
          </button>
          <button mat-raised-button class="access-button">
            Billing
          </button>
        </div>
      </mat-card>

      <div class="dashboard-container">
        <div class="charts-container">
          <mat-card class="chart-card">
            <div class="card-title">Highest Turnover</div>
            <canvas #chartHighRotation></canvas>
          </mat-card>

          <mat-card class="chart-card">
            <div class="card-title">Lowest Turnover</div>
            <canvas #chartLowRotation></canvas>
          </mat-card>
        </div>

        <mat-card class="table-card">
          <div class="table-header">
            <div class="table-title">Expiration Risk</div>
            <mat-form-field appearance="fill" class="filter-dropdown">
              <mat-label>Ordenar por</mat-label>
              <mat-select>
                <mat-option value="high">Highest</mat-option>
                <mat-option value="low">Lowest</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <table mat-table [dataSource]="products" class="mat-elevation-z1">
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef> Nombre </th>
              <td mat-cell *matCellDef="let element"> {{ element.name }} </td>
            </ng-container>

            <ng-container matColumnDef="type">
              <th mat-header-cell *matHeaderCellDef> Tipo </th>
              <td mat-cell *matCellDef="let element"> {{ element.type }} </td>
            </ng-container>

            <ng-container matColumnDef="expiration">
              <th mat-header-cell *matHeaderCellDef> Fecha de caducidad </th>
              <td mat-cell *matCellDef="let element"> {{ element.expiration | date }} </td>
            </ng-container>

            <ng-container matColumnDef="stock">
              <th mat-header-cell *matHeaderCellDef> Stock actual </th>
              <td mat-cell *matCellDef="let element"> {{ element.stock }} </td>
            </ng-container>

            <ng-container matColumnDef="minStock">
              <th mat-header-cell *matHeaderCellDef> Stock m√≠nimo </th>
              <td mat-cell *matCellDef="let element"> {{ element.minStock }} </td>
            </ng-container>

            <ng-container matColumnDef="price">
              <th mat-header-cell *matHeaderCellDef> Precio </th>
              <td mat-cell *matCellDef="let element"> ${{ element.price }} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </mat-card>
      </div>

    </div>

  </div>


</div>
